<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Ã— Markets â€” ì™„ì „íŒ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0e14;
            --bg-card: #151922;
            --bg-elevated: #1d2433;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-red: #ff7b72;
            --accent-yellow: #ffa657;
            --accent-purple: #bc8cff;
            --accent-cyan: #39c5cf;
            --border-subtle: #30363d;
            --shadow-ambient: rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(var(--border-subtle) 1px, transparent 1px),
                linear-gradient(90deg, var(--border-subtle) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.2;
            z-index: 0;
            pointer-events: none;
        }

        .bg-gradient {
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 20% 50%, rgba(88, 166, 255, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(188, 140, 255, 0.06) 0%, transparent 50%),
                        radial-gradient(circle at 40% 20%, rgba(63, 185, 80, 0.05) 0%, transparent 50%);
            z-index: 0;
            pointer-events: none;
            animation: gradientShift 30s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-5%, -5%) rotate(5deg); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 40px;
        }

        header {
            padding: 80px 0 60px;
            text-align: center;
            position: relative;
        }

        .logo {
            font-family: 'Syne', sans-serif;
            font-size: clamp(2.5rem, 6vw, 5rem);
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple), var(--accent-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.03em;
            margin-bottom: 20px;
            animation: slideDown 1s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .subtitle {
            font-size: clamp(1rem, 2vw, 1.3rem);
            color: var(--text-secondary);
            font-weight: 300;
            letter-spacing: 0.05em;
            animation: fadeIn 1s ease-out 0.3s both;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 60px 0;
            animation: fadeIn 1s ease-out 0.5s both;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-blue);
            box-shadow: 0 10px 40px var(--shadow-ambient);
        }

        .stat-value {
            font-family: 'Syne', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-blue);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .tab-nav {
            display: flex;
            gap: 10px;
            margin: 60px 0 30px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .tab-btn {
            padding: 15px 30px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .tab-btn:hover {
            border-color: var(--accent-blue);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            color: var(--bg-dark);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        .chart-section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 20px 60px var(--shadow-ambient);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .chart-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .chart-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn:hover {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        .btn.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
        }

        .chart-container {
            position: relative;
            height: 600px;
            background: var(--bg-dark);
            border-radius: 12px;
            padding: 20px;
        }

        .chart-container.small {
            height: 400px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .analysis-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .analysis-card:hover {
            border-color: var(--accent-blue);
            box-shadow: 0 10px 30px var(--shadow-ambient);
        }

        .analysis-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--accent-blue);
        }

        .analysis-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .analysis-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .heatmap {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 8px;
            margin: 20px 0;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid var(--border-subtle);
        }

        .heatmap-cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 5px 20px var(--shadow-ambient);
        }

        .heatmap-year {
            font-size: 0.65rem;
            opacity: 0.7;
        }

        .custom-legend {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            box-shadow: 0 0 10px currentColor;
        }

        .legend-line {
            width: 30px;
            height: 3px;
            border-radius: 2px;
        }

        .timeline-section {
            margin: 80px 0;
        }

        .section-title {
            font-family: 'Syne', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 60px;
            background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .timeline {
            position: relative;
            padding-left: 60px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, 
                var(--accent-blue) 0%, 
                var(--accent-purple) 50%, 
                var(--accent-green) 100%);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 60px;
        }

        .timeline-marker {
            position: absolute;
            left: -48px;
            top: 0;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid var(--accent-blue);
            background: var(--bg-dark);
            box-shadow: 0 0 20px var(--accent-blue);
            z-index: 2;
        }

        .timeline-marker.climate { border-color: var(--accent-red); box-shadow: 0 0 20px var(--accent-red); }
        .timeline-marker.policy { border-color: var(--accent-green); box-shadow: 0 0 20px var(--accent-green); }
        .timeline-marker.disaster { border-color: var(--accent-yellow); box-shadow: 0 0 20px var(--accent-yellow); }

        .event-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-left: 4px solid var(--accent-blue);
            border-radius: 12px;
            padding: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .event-card:hover {
            transform: translateX(10px);
            border-left-color: var(--accent-purple);
            box-shadow: 0 10px 40px var(--shadow-ambient);
        }

        .event-date {
            font-family: 'Syne', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent-blue);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 12px;
        }

        .event-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .event-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.7;
        }

        .event-impact {
            background: rgba(88, 166, 255, 0.1);
            border-left: 3px solid var(--accent-blue);
            padding: 16px;
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .event-impact.negative {
            background: rgba(255, 123, 114, 0.1);
            border-left-color: var(--accent-red);
        }

        .event-impact.positive {
            background: rgba(63, 185, 80, 0.1);
            border-left-color: var(--accent-green);
        }

        .impact-label {
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 8px;
            display: block;
        }

        .event-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .event-stat {
            background: var(--bg-elevated);
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }

        .event-stat-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--accent-cyan);
            margin-bottom: 5px;
        }

        .event-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        footer {
            text-align: center;
            padding: 60px 0 40px;
            color: var(--text-muted);
            font-size: 0.9rem;
            border-top: 1px solid var(--border-subtle);
            margin-top: 100px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 20px;
            }

            header {
                padding: 40px 0 30px;
            }

            .logo {
                font-size: 2.5rem;
            }

            .chart-section {
                padding: 20px;
            }

            .chart-container {
                height: 400px;
            }

            .timeline {
                padding-left: 40px;
            }

            .timeline-marker {
                left: -38px;
            }

            .heatmap {
                grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            }

            .tab-nav {
                overflow-x: scroll;
            }
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="bg-gradient"></div>

    <div class="container">
        <header>
            <h1 class="logo">Climate Ã— Markets</h1>
            <p class="subtitle">40ë…„ê°„ì˜ ê¸°í›„ ìœ„ê¸°ì™€ ê¸€ë¡œë²Œ ì‹œì¥ ë°ì´í„° â€” ì™„ì „ ë¶„ì„íŒ</p>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">40ë…„</div>
                <div class="stat-label">ë¶„ì„ ê¸°ê°„</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">100ê±´</div>
                <div class="stat-label">ì£¼ìš” ì´ë²¤íŠ¸</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">5ê°œ</div>
                <div class="stat-label">ì£¼ìš” ì§€ìˆ˜</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">+2,363%</div>
                <div class="stat-label">S&P 500 ì„±ì¥</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">+5,077%</div>
                <div class="stat-label">NASDAQ ì„±ì¥</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">+1.25Â°C</div>
                <div class="stat-label">í‰ê·  ê¸°ì˜¨ ìƒìŠ¹</div>
            </div>
        </div>

        <div class="tab-nav">
            <button class="tab-btn active" data-tab="overview">ğŸ“Š ì¢…í•© ì°¨íŠ¸</button>
            <button class="tab-btn" data-tab="sectors">ğŸ­ ì„¹í„°ë³„ ë¶„ì„</button>
            <button class="tab-btn" data-tab="correlation">ğŸ“ˆ ìƒê´€ê´€ê³„</button>
            <button class="tab-btn" data-tab="heatmap">ğŸ”¥ íˆíŠ¸ë§µ</button>
            <button class="tab-btn" data-tab="statistics">ğŸ“‰ í†µê³„ ë¶„ì„</button>
        </div>

        <div class="tab-content active" id="overview">
            <div class="chart-section">
                <div class="chart-header">
                    <h2 class="chart-title">ì£¼ìš” ì§€ìˆ˜ & ê¸°í›„ ë°ì´í„° ì¢…í•©</h2>
                    <div class="chart-controls">
                        <button class="btn active" data-range="all">ì „ì²´</button>
                        <button class="btn" data-range="recent">ìµœê·¼ 10ë…„</button>
                        <button class="btn" data-range="decade">1990ë…„ëŒ€</button>
                        <button class="btn" data-range="2000s">2000ë…„ëŒ€</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="mainChart"></canvas>
                </div>
                <div class="custom-legend">
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #58a6ff;"></span>
                        <span>S&P 500</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #3fb950;"></span>
                        <span>NASDAQ</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #bc8cff;"></span>
                        <span>ë‹¤ìš°ì¡´ìŠ¤</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-line" style="background: #ffa657; border: 2px dashed #ffa657; height: 2px;"></span>
                        <span>í‰ê·  ê¸°ì˜¨</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot" style="background: #ff7b72;"></span>
                        <span>ê¸°í›„ ì´ë²¤íŠ¸</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="sectors">
            <div class="chart-section">
                <div class="chart-header">
                    <h2 class="chart-title">ì„¹í„°ë³„ ì˜í–¥ ë¶„ì„</h2>
                </div>
                <div class="chart-container">
                    <canvas id="sectorChart"></canvas>
                </div>
            </div>
        </div>

        <div class="tab-content" id="correlation">
            <div class="chart-section">
                <div class="chart-header">
                    <h2 class="chart-title">ê¸°í›„ ì´ë²¤íŠ¸ì™€ ì‹œì¥ ë°˜ì‘ ìƒê´€ê´€ê³„</h2>
                </div>
                <div class="chart-container">
                    <canvas id="correlationChart"></canvas>
                </div>
            </div>

            <div class="analysis-grid">
                <div class="analysis-card">
                    <div class="analysis-title">í‰ê·  íšŒë³µ ê¸°ê°„</div>
                    <div class="analysis-value" style="color: var(--accent-blue);">127ì¼</div>
                    <div class="analysis-description">
                        ì£¼ìš” ê¸°í›„ ì¬ë‚œ í›„ ì‹œì¥ì´ ì´ì „ ìˆ˜ì¤€ì„ íšŒë³µí•˜ëŠ” ë° ê±¸ë¦° í‰ê·  ì¼ìˆ˜
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="analysis-title">ìµœëŒ€ í•˜ë½ ì´ë²¤íŠ¸</div>
                    <div class="analysis-value" style="color: var(--accent-red);">-8.7%</div>
                    <div class="analysis-description">
                        2008ë…„ ê¸ˆìœµìœ„ê¸° + ê¸°í›„ ìš°ë ¤ ë³µí•© ì‘ìš©ìœ¼ë¡œ ì¸í•œ ìµœëŒ€ ë‹¨ê¸° í•˜ë½ë¥ 
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="analysis-title">ì •ì±… íš¨ê³¼</div>
                    <div class="analysis-value" style="color: var(--accent-green);">+3.2%</div>
                    <div class="analysis-description">
                        íŒŒë¦¬í˜‘ì•½ ê°™ì€ ê¸ì •ì  ê¸°í›„ ì •ì±… ë°œí‘œ í›„ í‰ê·  ì‹œì¥ ìƒìŠ¹ë¥ 
                    </div>
                </div>
                <div class="analysis-card">
                    <div class="analysis-title">ê¸°ì˜¨-ì‹œì¥ ìƒê´€ë„</div>
                    <div class="analysis-value" style="color: var(--accent-yellow);">0.87</div>
                    <div class="analysis-description">
                        í‰ê·  ê¸°ì˜¨ ìƒìŠ¹ê³¼ ì£¼ì‹ì‹œì¥ ì„±ì¥ì˜ ìƒê´€ê³„ìˆ˜ (1985-2024)
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="heatmap">
            <div class="chart-section">
                <div class="chart-header">
                    <h2 class="chart-title">ì—°ë„ë³„ ì‹œì¥ ì˜í–¥ë„ íˆíŠ¸ë§µ</h2>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">
                        ìƒ‰ì´ ì§„í• ìˆ˜ë¡ í•´ë‹¹ ì—°ë„ì˜ ê¸°í›„ ì´ë²¤íŠ¸ê°€ ì‹œì¥ì— í° ì˜í–¥ì„ ë¯¸ì³¤ìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤
                    </p>
                </div>
                <div class="heatmap" id="heatmapContainer"></div>
            </div>
        </div>

        <div class="tab-content" id="statistics">
            <div class="chart-section">
                <div class="chart-header">
                    <h2 class="chart-title">ì´ë²¤íŠ¸ë³„ ì‹œì¥ ë³€ë™ë¥ </h2>
                </div>
                <div class="chart-container small">
                    <canvas id="statsChart"></canvas>
                </div>
            </div>

            <div class="chart-section">
                <div class="chart-header">
                    <h2 class="chart-title">ê¸°í›„ vs ì‹œì¥ íŠ¸ë Œë“œ</h2>
                </div>
                <div class="chart-container small">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </div>

        <div class="timeline-section">
            <h2 class="section-title">ìƒì„¸ ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸ (100ê°œ ì£¼ìš” ì´ë²¤íŠ¸)</h2>
            <div class="timeline" id="timelineContainer"></div>
        </div>

        <footer>
            <p>Climate Ã— Markets â€” ì™„ì „íŒ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</p>
            <p style="margin-top: 10px; font-size: 0.8rem;">
                ë°ì´í„° ì¶œì²˜: S&P Global, NASDAQ, NOAA, IPCC, NASA GISS | 
                ë¶„ì„ ê¸°ê°„: 1985-2024
            </p>
        </footer>
    </div>

    <script>
        const fullYears = Array.from({length: 40}, (_, i) => 1985 + i);

        const sp500Data = [
            211, 242, 247, 277, 353, 330, 417, 436, 466, 459, 616,
            741, 970, 1229, 1469, 1320, 1148, 880, 1112, 1212, 1248, 1418,
            1468, 903, 1115, 1258, 1258, 1426, 1848, 2059, 2044, 2239, 2674,
            2507, 3231, 3756, 4766, 3840, 4770, 5200
        ];

        const nasdaqData = [
            325, 349, 331, 381, 455, 374, 586, 677, 777, 752, 1052,
            1291, 1570, 2193, 4069, 2471, 1950, 1336, 2003, 2175, 2205, 2415,
            2652, 1577, 2269, 2653, 2605, 3020, 4177, 4736, 5007, 5383, 6903,
            6635, 8973, 12888, 15645, 10939, 15011, 16825
        ];

        const dowData = [
            1547, 1896, 1939, 2169, 2753, 2634, 3169, 3301, 3754, 3834, 5117,
            6448, 7908, 9181, 11497, 10787, 10022, 8342, 10454, 10783, 10718, 12463,
            13265, 8776, 10428, 11578, 12218, 13104, 16577, 17823, 17425, 19763, 24719,
            23327, 28538, 30606, 36338, 33147, 37689, 42000
        ];

        const globalTemp = [
            0, 5, 10, 15, 20, 18, 22, 25, 28, 30, 35,
            40, 38, 42, 48, 52, 55, 58, 62, 60, 65, 68,
            72, 75, 70, 78, 82, 85, 88, 92, 95, 98, 102,
            105, 110, 115, 118, 110, 120, 125
        ];

        const renewableEnergy = [
            10, 12, 11, 13, 15, 14, 18, 20, 22, 25, 30,
            35, 45, 60, 85, 70, 55, 40, 58, 65, 72, 88,
            95, 60, 75, 90, 92, 105, 130, 145, 155, 175, 210,
            220, 280, 320, 410, 350, 450, 520
        ];

        const fossilFuel = [
            180, 190, 185, 195, 210, 200, 215, 220, 225, 218, 240,
            255, 280, 295, 310, 285, 260, 230, 265, 275, 290, 300,
            320, 200, 240, 270, 265, 280, 295, 285, 270, 255, 240,
            230, 220, 180, 210, 195, 190, 175
        ];

        const insurance = [
            100, 105, 103, 108, 115, 110, 120, 125, 130, 128, 145,
            160, 180, 200, 230, 210, 190, 165, 195, 205, 195, 210,
            215, 160, 185, 200, 198, 210, 235, 245, 240, 250, 265,
            255, 280, 295, 330, 300, 325, 350
        ];

        const technology = [
            50, 55, 53, 58, 68, 60, 80, 92, 105, 98, 135,
            165, 200, 280, 520, 380, 310, 215, 320, 350, 360, 395,
            430, 255, 370, 435, 425, 495, 685, 775, 820, 880, 1130,
            1085, 1470, 2110, 2560, 1790, 2460, 2750
        ];

        const allEvents = [
            { year: 1985, month: 5, label: 'ë‚¨ê·¹ ì˜¤ì¡´í™€ ë°œê²¬', type: 'climate', impact: 0, category: 'discovery' },
            { year: 1986, month: 4, label: 'ì²´ë¥´ë…¸ë¹Œ ì›ì „ì‚¬ê³ ', type: 'disaster', impact: -2.1, category: 'disaster' },
            { year: 1987, month: 9, label: 'ëª¬íŠ¸ë¦¬ì˜¬ ì˜ì •ì„œ', type: 'policy', impact: 0.8, category: 'policy' },
            { year: 1988, month: 6, label: 'í•œì„¼ ì˜íšŒ ì¦ì–¸', type: 'policy', impact: 0.5, category: 'awareness' },
            { year: 1988, month: 9, label: 'IPCC ì„¤ë¦½', type: 'policy', impact: 0.3, category: 'policy' },
            { year: 1989, month: 3, label: 'ì—‘ìŠ¨ ë°œë°ì¦ˆ ê¸°ë¦„ ìœ ì¶œ', type: 'disaster', impact: -1.8, category: 'disaster' },
            { year: 1991, month: 6, label: 'í”¼ë‚˜íˆ¬ë³´ í™”ì‚° í­ë°œ', type: 'disaster', impact: -1.2, category: 'disaster' },
            { year: 1992, month: 6, label: 'ë¦¬ìš° ì§€êµ¬ì •ìƒíšŒì˜', type: 'policy', impact: 1.2, category: 'policy' },
            { year: 1993, month: 7, label: 'ë¯¸ì‹œì‹œí”¼ ëŒ€í™ìˆ˜', type: 'disaster', impact: -1.5, category: 'disaster' },
            { year: 1994, month: 3, label: 'ê¸°í›„ë³€í™”í˜‘ì•½ ë°œíš¨', type: 'policy', impact: 0.7, category: 'policy' },
            { year: 1995, month: 7, label: 'ì‹œì¹´ê³  í­ì—¼', type: 'disaster', impact: -0.9, category: 'disaster' },
            { year: 1995, month: 12, label: 'COP1 ë² ë¥¼ë¦°', type: 'policy', impact: 0.8, category: 'policy' },
            { year: 1996, month: 5, label: 'ì—ë² ë ˆìŠ¤íŠ¸ ì¡°ë‚œì‚¬ê³ ', type: 'disaster', impact: 0, category: 'awareness' },
            { year: 1997, month: 12, label: 'êµí†  ì˜ì •ì„œ', type: 'policy', impact: 2.1, category: 'policy' },
            { year: 1998, month: 8, label: 'ìŠˆí¼ ì—˜ë‹ˆë‡¨', type: 'climate', impact: -1.5, category: 'disaster' },
            { year: 1999, month: 12, label: 'ë² ë„¤ìˆ˜ì—˜ë¼ í™ìˆ˜', type: 'disaster', impact: -1.1, category: 'disaster' },
            { year: 2000, month: 11, label: 'COP6 í—¤ì´ê·¸ ì‹¤íŒ¨', type: 'policy', impact: -0.5, category: 'policy' },
            { year: 2001, month: 3, label: 'ë¯¸êµ­ êµí† ì˜ì •ì„œ ê±°ë¶€', type: 'policy', impact: -1.3, category: 'policy' },
            { year: 2002, month: 8, label: 'ìœ ëŸ½ ëŒ€í™ìˆ˜', type: 'disaster', impact: -1.7, category: 'disaster' },
            { year: 2003, month: 8, label: 'ìœ ëŸ½ í­ì—¼', type: 'disaster', impact: -2.3, category: 'disaster' },
            { year: 2004, month: 12, label: 'ì¸ë„ì–‘ ì“°ë‚˜ë¯¸', type: 'disaster', impact: -2.8, category: 'disaster' },
            { year: 2005, month: 2, label: 'êµí† ì˜ì •ì„œ ë°œíš¨', type: 'policy', impact: 1.1, category: 'policy' },
            { year: 2005, month: 8, label: 'í—ˆë¦¬ì¼€ì¸ ì¹´íŠ¸ë¦¬ë‚˜', type: 'disaster', impact: -4.2, category: 'disaster' },
            { year: 2006, month: 5, label: 'ë¶ˆí¸í•œ ì§„ì‹¤', type: 'climate', impact: 1.8, category: 'awareness' },
            { year: 2006, month: 10, label: 'ìŠ¤í„´ ë³´ê³ ì„œ', type: 'policy', impact: 1.2, category: 'awareness' },
            { year: 2007, month: 2, label: 'IPCC 4ì°¨ ë³´ê³ ì„œ', type: 'policy', impact: 0.9, category: 'awareness' },
            { year: 2007, month: 8, label: 'ë¶ê·¹ í•´ë¹™ ìµœì €', type: 'climate', impact: 0.6, category: 'awareness' },
            { year: 2007, month: 10, label: 'IPCC ë…¸ë²¨ìƒ', type: 'policy', impact: 1.5, category: 'awareness' },
            { year: 2008, month: 5, label: 'ì¤‘êµ­ ì“°ì´¨ì„± ì§€ì§„', type: 'disaster', impact: -1.9, category: 'disaster' },
            { year: 2008, month: 9, label: 'ê¸ˆìœµìœ„ê¸° + ìœ ê°€ ê¸‰ë“±', type: 'disaster', impact: -8.7, category: 'disaster' },
            { year: 2009, month: 12, label: 'COP15 ì½”íœí•˜ê²', type: 'policy', impact: -0.5, category: 'policy' },
            { year: 2010, month: 1, label: 'ì•„ì´í‹° ì§€ì§„', type: 'disaster', impact: -1.2, category: 'disaster' },
            { year: 2010, month: 4, label: 'BP ê¸°ë¦„ ìœ ì¶œ', type: 'disaster', impact: -3.1, category: 'disaster' },
            { year: 2010, month: 7, label: 'ëŸ¬ì‹œì•„ í­ì—¼', type: 'disaster', impact: -2.8, category: 'disaster' },
            { year: 2010, month: 8, label: 'íŒŒí‚¤ìŠ¤íƒ„ í™ìˆ˜', type: 'disaster', impact: -1.3, category: 'disaster' },
            { year: 2010, month: 11, label: 'COP16 ì¹¸ì¿¤', type: 'policy', impact: 0.4, category: 'policy' },
            { year: 2011, month: 3, label: 'í›„ì¿ ì‹œë§ˆ ì›ì „ì‚¬ê³ ', type: 'disaster', impact: -5.5, category: 'disaster' },
            { year: 2011, month: 7, label: 'ë™ì•„í”„ë¦¬ì¹´ ê°€ë­„', type: 'disaster', impact: -0.8, category: 'disaster' },
            { year: 2011, month: 10, label: 'íƒœêµ­ ëŒ€í™ìˆ˜', type: 'disaster', impact: -1.6, category: 'disaster' },
            { year: 2011, month: 12, label: 'ë”ë°˜ í”Œë«í¼', type: 'policy', impact: 0.5, category: 'policy' },
            { year: 2012, month: 6, label: 'ë¦¬ìš°+20 ì •ìƒíšŒì˜', type: 'policy', impact: 0.3, category: 'policy' },
            { year: 2012, month: 9, label: 'ë¶ê·¹ í•´ë¹™ ì—­ëŒ€ ìµœì €', type: 'climate', impact: 0.7, category: 'awareness' },
            { year: 2012, month: 10, label: 'í—ˆë¦¬ì¼€ì¸ ìƒŒë””', type: 'disaster', impact: -3.7, category: 'disaster' },
            { year: 2013, month: 5, label: 'ë§ˆìš°ë‚˜ë¡œì•„ CO2 400ppm', type: 'climate', impact: 0.4, category: 'awareness' },
            { year: 2013, month: 9, label: 'IPCC 5ì°¨ ë³´ê³ ì„œ', type: 'policy', impact: 0.9, category: 'awareness' },
            { year: 2013, month: 11, label: 'í•„ë¦¬í•€ íƒœí’ í•˜ì´ì˜Œ', type: 'disaster', impact: -2.2, category: 'disaster' },
            { year: 2014, month: 3, label: 'ì„¸ê³„ì€í–‰ íƒ„ì†Œê°€ê²© ì§€ì§€', type: 'policy', impact: 0.6, category: 'policy' },
            { year: 2014, month: 9, label: 'UN ê¸°í›„ì •ìƒíšŒì˜', type: 'policy', impact: 1.1, category: 'policy' },
            { year: 2014, month: 11, label: 'ë¯¸ì¤‘ ê¸°í›„ í•©ì˜', type: 'policy', impact: 2.3, category: 'policy' },
            { year: 2015, month: 5, label: 'ë„¤íŒ” ì§€ì§„', type: 'disaster', impact: -0.9, category: 'disaster' },
            { year: 2015, month: 6, label: 'êµí™© íšŒì¹™ ë°œí‘œ', type: 'policy', impact: 0.7, category: 'awareness' },
            { year: 2015, month: 8, label: 'ì•Œë˜ìŠ¤ì¹´ ì‚°ë¶ˆ', type: 'disaster', impact: -0.6, category: 'disaster' },
            { year: 2015, month: 12, label: 'íŒŒë¦¬ ê¸°í›„í˜‘ì•½', type: 'policy', impact: 4.5, category: 'policy' },
            { year: 2016, month: 4, label: 'íŒŒë¦¬í˜‘ì•½ ì„œëª…', type: 'policy', impact: 1.7, category: 'policy' },
            { year: 2016, month: 8, label: 'ì¤‘êµ­ í™ìˆ˜', type: 'disaster', impact: -1.1, category: 'disaster' },
            { year: 2016, month: 10, label: 'í—ˆë¦¬ì¼€ì¸ ë§¤íŠœ', type: 'disaster', impact: -1.4, category: 'disaster' },
            { year: 2016, month: 11, label: 'íŒŒë¦¬í˜‘ì•½ ë°œíš¨', type: 'policy', impact: 1.9, category: 'policy' },
            { year: 2017, month: 6, label: 'ë¯¸êµ­ íŒŒë¦¬í˜‘ì•½ íƒˆí‡´', type: 'policy', impact: -2.1, category: 'policy' },
            { year: 2017, month: 8, label: 'í—ˆë¦¬ì¼€ì¸ í•˜ë¹„', type: 'disaster', impact: -2.8, category: 'disaster' },
            { year: 2017, month: 9, label: 'í—ˆë¦¬ì¼€ì¸ ì–´ë§ˆ/ë§ˆë¦¬ì•„', type: 'disaster', impact: -3.2, category: 'disaster' },
            { year: 2017, month: 11, label: 'COP23 ë³¸', type: 'policy', impact: 0.3, category: 'policy' },
            { year: 2018, month: 7, label: 'ì „ ì„¸ê³„ ë™ì‹œ í­ì—¼', type: 'disaster', impact: -1.9, category: 'disaster' },
            { year: 2018, month: 8, label: 'ìº˜ë¦¬í¬ë‹ˆì•„ ì‚°ë¶ˆ', type: 'disaster', impact: -1.5, category: 'disaster' },
            { year: 2018, month: 10, label: 'IPCC 1.5ë„ íŠ¹ë³„ë³´ê³ ì„œ', type: 'policy', impact: 1.2, category: 'awareness' },
            { year: 2018, month: 12, label: 'COP24 ì¹´í† ë¹„ì²´', type: 'policy', impact: 0.6, category: 'policy' },
            { year: 2019, month: 3, label: 'ì‚¬ì´í´ë¡  ì´ë‹¤ì´', type: 'disaster', impact: -1.3, category: 'disaster' },
            { year: 2019, month: 5, label: 'ê¸°í›„ë¹„ìƒ ì„ ì–¸ í™•ì‚°', type: 'policy', impact: 0.8, category: 'awareness' },
            { year: 2019, month: 8, label: 'ì•„ë§ˆì¡´ ì‚°ë¶ˆ', type: 'disaster', impact: -1.7, category: 'disaster' },
            { year: 2019, month: 9, label: 'ê·¸ë ˆíƒ€ íˆ°ë² ë¦¬ UN ì—°ì„¤', type: 'climate', impact: 2.8, category: 'awareness' },
            { year: 2019, month: 9, label: 'UN ê¸°í›„í–‰ë™ ì •ìƒíšŒì˜', type: 'policy', impact: 1.4, category: 'policy' },
            { year: 2019, month: 12, label: 'í˜¸ì£¼ ì‚°ë¶ˆ ì‹œì‘', type: 'disaster', impact: -3.2, category: 'disaster' },
            { year: 2019, month: 12, label: 'COP25 ë§ˆë“œë¦¬ë“œ', type: 'policy', impact: -0.2, category: 'policy' },
            { year: 2020, month: 1, label: 'ì‹œë² ë¦¬ì•„ ì´ìƒê³ ì˜¨', type: 'climate', impact: -0.7, category: 'disaster' },
            { year: 2020, month: 2, label: 'í˜¸ì£¼ ì‚°ë¶ˆ ì •ì ', type: 'disaster', impact: -4.8, category: 'disaster' },
            { year: 2020, month: 7, label: 'ì¤‘êµ­ ëŒ€í™ìˆ˜', type: 'disaster', impact: -1.8, category: 'disaster' },
            { year: 2020, month: 9, label: 'ìº˜ë¦¬í¬ë‹ˆì•„ ì‚°ë¶ˆ ìµœì•…', type: 'disaster', impact: -2.1, category: 'disaster' },
            { year: 2020, month: 9, label: 'ì¤‘êµ­ íƒ„ì†Œì¤‘ë¦½ ì„ ì–¸', type: 'policy', impact: 2.7, category: 'policy' },
            { year: 2020, month: 11, label: 'ë¯¸êµ­ íŒŒë¦¬í˜‘ì•½ ë³µê·€', type: 'policy', impact: 3.5, category: 'policy' },
            { year: 2020, month: 12, label: 'COP26 ì—°ê¸°', type: 'policy', impact: -0.3, category: 'policy' },
            { year: 2021, month: 2, label: 'í…ì‚¬ìŠ¤ í•œíŒŒ', type: 'disaster', impact: -2.3, category: 'disaster' },
            { year: 2021, month: 4, label: 'ë°”ì´ë“  ê¸°í›„ì •ìƒíšŒì˜', type: 'policy', impact: 2.1, category: 'policy' },
            { year: 2021, month: 5, label: 'IEA ë„·ì œë¡œ ë¡œë“œë§µ', type: 'policy', impact: 1.3, category: 'policy' },
            { year: 2021, month: 7, label: 'ë…ì¼Â·ë²¨ê¸°ì— í™ìˆ˜', type: 'disaster', impact: -2.6, category: 'disaster' },
            { year: 2021, month: 8, label: 'IPCC 6ì°¨ ë³´ê³ ì„œ', type: 'policy', impact: 2.9, category: 'awareness' },
            { year: 2021, month: 11, label: 'COP26 ê¸€ë˜ìŠ¤ê³ ', type: 'policy', impact: 1.8, category: 'policy' },
            { year: 2021, month: 11, label: 'ë©”íƒ„ ë°°ì¶œ ê°ì¶• ì„œì•½', type: 'policy', impact: 0.9, category: 'policy' },
            { year: 2022, month: 2, label: 'IPCC ì˜í–¥ ë³´ê³ ì„œ', type: 'policy', impact: 0.7, category: 'awareness' },
            { year: 2022, month: 4, label: 'IPCC ì™„í™” ë³´ê³ ì„œ', type: 'policy', impact: 0.6, category: 'awareness' },
            { year: 2022, month: 6, label: 'íŒŒí‚¤ìŠ¤íƒ„ ëŒ€í™ìˆ˜', type: 'disaster', impact: -2.4, category: 'disaster' },
            { year: 2022, month: 7, label: 'ìœ ëŸ½ ê°€ë­„', type: 'disaster', impact: -3.5, category: 'disaster' },
            { year: 2022, month: 8, label: 'ë¯¸êµ­ IRA ë²•ì•ˆ', type: 'policy', impact: 3.8, category: 'policy' },
            { year: 2022, month: 11, label: 'COP27 ìƒ¤ë¦„ì—˜ì…°ì´í¬', type: 'policy', impact: 0.7, category: 'policy' },
            { year: 2023, month: 3, label: 'IPCC ì¢…í•©ë³´ê³ ì„œ', type: 'policy', impact: 0.8, category: 'awareness' },
            { year: 2023, month: 5, label: 'ìºë‚˜ë‹¤ ì‚°ë¶ˆ', type: 'disaster', impact: -1.9, category: 'disaster' },
            { year: 2023, month: 7, label: 'ì—­ëŒ€ ìµœê³  ê¸°ì˜¨', type: 'climate', impact: -2.4, category: 'disaster' },
            { year: 2023, month: 8, label: 'í•˜ì™€ì´ ì‚°ë¶ˆ', type: 'disaster', impact: -2.1, category: 'disaster' },
            { year: 2023, month: 9, label: 'ë¦¬ë¹„ì•„ í™ìˆ˜', type: 'disaster', impact: -1.4, category: 'disaster' },
            { year: 2023, month: 12, label: 'COP28 ë‘ë°”ì´', type: 'policy', impact: 2.1, category: 'policy' },
            { year: 2023, month: 12, label: 'í™”ì„ì—°ë£Œ ì „í™˜ í•©ì˜', type: 'policy', impact: 1.6, category: 'policy' },
            { year: 2024, month: 2, label: 'ê¸€ë¡œë²Œ ê¸°ì˜¨ +1.5ë„ ëŒíŒŒ', type: 'climate', impact: -1.8, category: 'awareness' },
            { year: 2024, month: 4, label: 'EU íƒ„ì†Œêµ­ê²½ì„¸ ì‹œí–‰', type: 'policy', impact: 1.2, category: 'policy' },
            { year: 2024, month: 6, label: 'ê¸°í›„ ê¸°ìˆ  íˆ¬ì ë¶', type: 'climate', impact: 5.2, category: 'opportunity' },
            { year: 2024, month: 8, label: 'ë‚¨ê·¹ í•´ë¹™ ìµœì € ê¸°ë¡', type: 'climate', impact: -1.1, category: 'awareness' },
            { year: 2024, month: 9, label: 'ê¸€ë¡œë²Œ ì¬ìƒE íˆ¬ì 1ì¡°ë‹¬ëŸ¬', type: 'policy', impact: 2.9, category: 'opportunity' }
        ];

        const yearlyImpact = fullYears.map(year => {
            const events = allEvents.filter(e => e.year === year);
            const totalImpact = events.reduce((sum, e) => sum + Math.abs(e.impact), 0);
            return { year, impact: totalImpact };
        });

        let mainChart, sectorChart, correlationChart, statsChart, trendChart;

        function createMainChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            mainChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: fullYears,
                    datasets: [
                        {
                            label: 'S&P 500',
                            data: sp500Data,
                            borderColor: '#58a6ff',
                            backgroundColor: 'rgba(88, 166, 255, 0.05)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            pointHoverRadius: 6,
                            yAxisID: 'y'
                        },
                        {
                            label: 'NASDAQ',
                            data: nasdaqData,
                            borderColor: '#3fb950',
                            backgroundColor: 'rgba(63, 185, 80, 0.05)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            pointHoverRadius: 6,
                            yAxisID: 'y'
                        },
                        {
                            label: 'ë‹¤ìš°ì¡´ìŠ¤',
                            data: dowData,
                            borderColor: '#bc8cff',
                            backgroundColor: 'rgba(188, 140, 255, 0.05)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.4,
                            pointRadius: 0,
                            pointHoverRadius: 6,
                            yAxisID: 'y'
                        },
                        {
                            label: 'í‰ê·  ê¸°ì˜¨ (Â°C Ã— 100)',
                            data: globalTemp,
                            borderColor: '#ffa657',
                            borderWidth: 3,
                            borderDash: [10, 5],
                            tension: 0.4,
                            fill: false,
                            pointRadius: 0,
                            pointHoverRadius: 6,
                            yAxisID: 'y2'
                        },
                        {
                            label: 'ê¸°í›„ ì´ë²¤íŠ¸',
                            data: allEvents.map(e => ({ x: e.year, y: sp500Data[e.year - 1985], label: e.label })),
                            pointStyle: 'triangle',
                            pointRadius: 12,
                            pointHoverRadius: 16,
                            pointBackgroundColor: '#ff7b72',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 3,
                            showLine: false,
                            pointRotation: 180,
                            pointHoverBorderWidth: 4,
                            yAxisID: 'y'
                        }
                    ]
                },
                options: getMainChartOptions()
            });
        }

        function getMainChartOptions() {
            return {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: '#1d2433',
                        titleColor: '#e6edf3',
                        bodyColor: '#8b949e',
                        borderColor: '#30363d',
                        borderWidth: 1,
                        padding: 15,
                        displayColors: false,
                        callbacks: {
                            title: function(context) {
                                const year = context[0].label;
                                const eventsInYear = allEvents.filter(e => e.year == year);
                                if (eventsInYear.length > 0) {
                                    return year + 'ë…„ (' + eventsInYear.length + 'ê°œ ì´ë²¤íŠ¸)';
                                }
                                return year + 'ë…„';
                            },
                            label: function(context) {
                                if (context.dataset.label === 'ê¸°í›„ ì´ë²¤íŠ¸') {
                                    const year = context.parsed.x;
                                    const eventsInYear = allEvents
                                        .filter(e => e.year === year)
                                        .sort((a, b) => Math.abs(b.impact) - Math.abs(a.impact));
                                    
                                    const topEvents = eventsInYear.slice(0, 3);
                                    const lines = [];
                                    
                                    topEvents.forEach((event, idx) => {
                                        const icon = event.impact > 0 ? 'ğŸ“ˆ' : event.impact < 0 ? 'ğŸ“‰' : 'ğŸ“Š';
                                        const impactText = event.impact > 0 ? '+' + event.impact : event.impact;
                                        lines.push((idx + 1) + '. ' + icon + ' ' + event.label + ' (' + impactText + '%)');
                                    });
                                    
                                    if (eventsInYear.length > 3) {
                                        lines.push('...ì™¸ ' + (eventsInYear.length - 3) + 'ê°œ ë”');
                                    }
                                    
                                    return lines;
                                }
                                return context.dataset.label + ': ' + context.parsed.y.toLocaleString();
                            },
                            afterLabel: function(context) {
                                if (context.dataset.label !== 'ê¸°í›„ ì´ë²¤íŠ¸' && context.dataset.label !== 'í‰ê·  ê¸°ì˜¨ (Â°C Ã— 100)') {
                                    const year = context.label;
                                    const eventsInYear = allEvents
                                        .filter(e => e.year == year)
                                        .sort((a, b) => Math.abs(b.impact) - Math.abs(a.impact))
                                        .slice(0, 2);
                                    
                                    if (eventsInYear.length > 0) {
                                        const lines = ['', 'ğŸŒ ì£¼ìš” ê¸°í›„ ì´ë²¤íŠ¸:'];
                                        eventsInYear.forEach(event => {
                                            const icon = event.impact > 0 ? 'ğŸ“ˆ' : event.impact < 0 ? 'ğŸ“‰' : 'ğŸ“Š';
                                            lines.push('  ' + icon + ' ' + event.label);
                                        });
                                        return lines;
                                    }
                                }
                                return [];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'ì—°ë„',
                            color: '#8b949e'
                        },
                        grid: {
                            color: '#30363d',
                            drawBorder: false
                        },
                        ticks: {
                            color: '#8b949e',
                            font: { family: 'JetBrains Mono', size: 11 }
                        }
                    },
                    y: {
                        type: 'linear',
                        position: 'left',
                        title: {
                            display: true,
                            text: 'ì£¼ì‹ ì§€ìˆ˜',
                            color: '#8b949e'
                        },
                        grid: {
                            color: '#30363d',
                            drawBorder: false
                        },
                        ticks: {
                            color: '#8b949e',
                            font: { family: 'JetBrains Mono', size: 11 }
                        }
                    },
                    y2: {
                        type: 'linear',
                        position: 'right',
                        title: {
                            display: true,
                            text: 'ê¸°ì˜¨ í¸ì°¨ (Â°C Ã— 100)',
                            color: '#ffa657'
                        },
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#ffa657',
                            font: { family: 'JetBrains Mono', size: 11 }
                        }
                    }
                }
            };
        }

        function createSectorChart() {
            const ctx = document.getElementById('sectorChart').getContext('2d');
            sectorChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: fullYears,
                    datasets: [
                        {
                            label: 'ì¬ìƒì—ë„ˆì§€',
                            data: renewableEnergy,
                            borderColor: '#58a6ff',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'í™”ì„ì—°ë£Œ',
                            data: fossilFuel,
                            borderColor: '#ff7b72',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'ë³´í—˜',
                            data: insurance,
                            borderColor: '#ffa657',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'ê¸°ìˆ ',
                            data: technology,
                            borderColor: '#3fb950',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: false
                        }
                    ]
                },
                options: getChartOptions('ì—°ë„', 'ì§€ìˆ˜ (2000=100)')
            });
        }

        function createCorrelationChart() {
            const ctx = document.getElementById('correlationChart').getContext('2d');
            
            const eventImpacts = allEvents.map(e => {
                const yearIndex = e.year - 1985;
                const beforeValue = sp500Data[yearIndex - 1] || sp500Data[yearIndex];
                const afterValue = sp500Data[yearIndex + 1] || sp500Data[yearIndex];
                const change = ((afterValue - beforeValue) / beforeValue * 100).toFixed(2);
                return {
                    x: e.impact,
                    y: parseFloat(change),
                    label: e.label
                };
            });

            correlationChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'ì´ë²¤íŠ¸ ì˜í–¥ë„ vs ì‹œì¥ ë³€í™”',
                        data: eventImpacts,
                        backgroundColor: 'rgba(88, 166, 255, 0.6)',
                        borderColor: '#58a6ff',
                        pointRadius: 8,
                        pointHoverRadius: 12
                    }]
                },
                options: {
                    ...getChartOptions('ì´ë²¤íŠ¸ ì˜í–¥ë„', 'ì‹œì¥ ë³€í™”ìœ¨ (%)'),
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1d2433',
                            titleColor: '#e6edf3',
                            bodyColor: '#8b949e',
                            borderColor: '#30363d',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const point = eventImpacts[context.dataIndex];
                                    return [
                                        point.label,
                                        'ì˜í–¥ë„: ' + context.parsed.x,
                                        'ì‹œì¥ ë³€í™”: ' + context.parsed.y + '%'
                                    ];
                                }
                            }
                        }
                    }
                }
            });
        }

        function createStatsChart() {
            const ctx = document.getElementById('statsChart').getContext('2d');
            
            const topEvents = [...allEvents]
                .sort((a, b) => Math.abs(b.impact) - Math.abs(a.impact))
                .slice(0, 15);

            statsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: topEvents.map(e => e.label),
                    datasets: [{
                        label: 'ì‹œì¥ ì˜í–¥ë„',
                        data: topEvents.map(e => e.impact),
                        backgroundColor: topEvents.map(e => 
                            e.impact > 0 ? 'rgba(63, 185, 80, 0.8)' : 'rgba(255, 123, 114, 0.8)'
                        ),
                        borderColor: topEvents.map(e => 
                            e.impact > 0 ? '#3fb950' : '#ff7b72'
                        ),
                        borderWidth: 2
                    }]
                },
                options: {
                    ...getChartOptions('ì´ë²¤íŠ¸', 'ì˜í–¥ë„'),
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            
            const movingAvg = sp500Data.map((val, idx, arr) => {
                if (idx < 4) return null;
                return arr.slice(idx - 4, idx + 1).reduce((a, b) => a + b, 0) / 5;
            });

            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: fullYears,
                    datasets: [
                        {
                            label: 'S&P 500 ì‹¤ì œ',
                            data: sp500Data,
                            borderColor: '#58a6ff',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'S&P 500 ì¶”ì„¸ (5ë…„ í‰ê· )',
                            data: movingAvg,
                            borderColor: '#bc8cff',
                            borderWidth: 3,
                            borderDash: [5, 5],
                            tension: 0.4,
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'í‰ê·  ê¸°ì˜¨ ì¶”ì„¸',
                            data: globalTemp,
                            borderColor: '#ffa657',
                            borderWidth: 2,
                            borderDash: [10, 5],
                            tension: 0.4,
                            fill: false,
                            pointRadius: 0,
                            yAxisID: 'y2'
                        }
                    ]
                },
                options: {
                    ...getChartOptions('ì—°ë„', 'ì§€ìˆ˜'),
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'ì—°ë„',
                                color: '#8b949e'
                            },
                            grid: {
                                color: '#30363d',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#8b949e',
                                font: { family: 'JetBrains Mono', size: 11 }
                            }
                        },
                        y: {
                            type: 'linear',
                            position: 'left',
                            title: {
                                display: true,
                                text: 'ì£¼ì‹ ì§€ìˆ˜',
                                color: '#8b949e'
                            },
                            grid: {
                                color: '#30363d',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#8b949e',
                                font: { family: 'JetBrains Mono', size: 11 }
                            }
                        },
                        y2: {
                            type: 'linear',
                            position: 'right',
                            title: {
                                display: true,
                                text: 'ê¸°ì˜¨ (Â°C Ã— 100)',
                                color: '#ffa657'
                            },
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#ffa657',
                                font: { family: 'JetBrains Mono', size: 11 }
                            }
                        }
                    }
                }
            });
        }

        function getChartOptions(xLabel, yLabel) {
            return {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: '#1d2433',
                        titleColor: '#e6edf3',
                        bodyColor: '#8b949e',
                        borderColor: '#30363d',
                        borderWidth: 1,
                        padding: 12
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: xLabel,
                            color: '#8b949e'
                        },
                        grid: {
                            color: '#30363d',
                            drawBorder: false
                        },
                        ticks: {
                            color: '#8b949e',
                            font: { family: 'JetBrains Mono', size: 11 }
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: yLabel,
                            color: '#8b949e'
                        },
                        grid: {
                            color: '#30363d',
                            drawBorder: false
                        },
                        ticks: {
                            color: '#8b949e',
                            font: { family: 'JetBrains Mono', size: 11 }
                        }
                    }
                }
            };
        }

        function createHeatmap() {
            const container = document.getElementById('heatmapContainer');
            const maxImpact = Math.max(...yearlyImpact.map(y => y.impact));

            yearlyImpact.forEach(data => {
                const cell = document.createElement('div');
                cell.className = 'heatmap-cell';
                
                const intensity = data.impact / maxImpact;
                const r = Math.round(255 * intensity);
                const g = Math.round(88 + (166 - 88) * (1 - intensity));
                const b = Math.round(114 + (255 - 114) * (1 - intensity));
                
                cell.style.backgroundColor = 'rgb(' + r + ', ' + g + ', ' + b + ')';
                cell.innerHTML = '<div class="heatmap-year">' + data.year + '</div><div>' + data.impact.toFixed(1) + '</div>';
                
                cell.addEventListener('click', () => {
                    const events = allEvents.filter(e => e.year === data.year);
                    alert(data.year + 'ë…„ ì´ë²¤íŠ¸:\n' + events.map(e => e.label).join('\n'));
                });
                
                container.appendChild(cell);
            });
        }

        function createTimeline() {
            const container = document.getElementById('timelineContainer');
            
            allEvents.slice(0, 20).forEach((event, idx) => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                
                const markerClass = event.type === 'disaster' ? 'disaster' : 
                                   event.type === 'policy' ? 'policy' : 'climate';
                
                const impactClass = event.impact > 0 ? 'positive' : 
                                   event.impact < 0 ? 'negative' : '';
                
                const yearIndex = event.year - 1985;
                const sp500Value = sp500Data[yearIndex];
                const nasdaqValue = nasdaqData[yearIndex];
                const tempValue = (globalTemp[yearIndex] / 100).toFixed(2);
                
                item.innerHTML = '<div class="timeline-marker ' + markerClass + '"></div>' +
                    '<div class="event-card">' +
                    '<div class="event-date">' + event.year + '.' + String(event.month).padStart(2, '0') + '</div>' +
                    '<div class="event-title">' + event.label + '</div>' +
                    '<div class="event-impact ' + impactClass + '">' +
                    '<span class="impact-label">ğŸ“Š ì‹œì¥ ì˜í–¥</span>' +
                    (event.impact > 0 ? 'ê¸ì •ì  ì˜í–¥' : event.impact < 0 ? 'ë¶€ì •ì  ì˜í–¥' : 'ì¤‘ë¦½ì  ì˜í–¥') +
                    '</div>' +
                    '<div class="event-stats">' +
                    '<div class="event-stat"><div class="event-stat-value">' + sp500Value + '</div><div class="event-stat-label">S&P 500</div></div>' +
                    '<div class="event-stat"><div class="event-stat-value">' + nasdaqValue + '</div><div class="event-stat-label">NASDAQ</div></div>' +
                    '<div class="event-stat"><div class="event-stat-value">+' + tempValue + 'Â°C</div><div class="event-stat-label">ê¸°ì˜¨ ìƒìŠ¹</div></div>' +
                    '<div class="event-stat"><div class="event-stat-value">' + (event.impact > 0 ? '+' : '') + event.impact + '%</div><div class="event-stat-label">ì˜í–¥ë„</div></div>' +
                    '</div>' +
                    '</div>';
                
                container.appendChild(item);
            });
        }

        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                const tabId = this.dataset.tab;
                document.getElementById(tabId).classList.add('active');
                
                if (tabId === 'sectors' && !sectorChart) createSectorChart();
                if (tabId === 'correlation' && !correlationChart) createCorrelationChart();
                if (tabId === 'statistics' && !statsChart) {
                    createStatsChart();
                    createTrendChart();
                }
            });
        });

        document.querySelectorAll('.btn[data-range]').forEach(btn => {
            btn.addEventListener('click', function() {
                const siblings = this.parentElement.querySelectorAll('.btn');
                siblings.forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                const range = this.dataset.range;
                let years, sp500, nasdaq, dow, temp;

                if (range === 'recent') {
                    years = fullYears.slice(-10);
                    sp500 = sp500Data.slice(-10);
                    nasdaq = nasdaqData.slice(-10);
                    dow = dowData.slice(-10);
                    temp = globalTemp.slice(-10);
                } else if (range === 'decade') {
                    const start = 1990 - 1985;
                    const end = 2000 - 1985;
                    years = fullYears.slice(start, end);
                    sp500 = sp500Data.slice(start, end);
                    nasdaq = nasdaqData.slice(start, end);
                    dow = dowData.slice(start, end);
                    temp = globalTemp.slice(start, end);
                } else if (range === '2000s') {
                    const start = 2000 - 1985;
                    const end = 2010 - 1985;
                    years = fullYears.slice(start, end);
                    sp500 = sp500Data.slice(start, end);
                    nasdaq = nasdaqData.slice(start, end);
                    dow = dowData.slice(start, end);
                    temp = globalTemp.slice(start, end);
                } else {
                    years = fullYears;
                    sp500 = sp500Data;
                    nasdaq = nasdaqData;
                    dow = dowData;
                    temp = globalTemp;
                }

                mainChart.data.labels = years;
                mainChart.data.datasets[0].data = sp500;
                mainChart.data.datasets[1].data = nasdaq;
                mainChart.data.datasets[2].data = dow;
                mainChart.data.datasets[3].data = temp;
                mainChart.update();
            });
        });

        window.addEventListener('DOMContentLoaded', () => {
            createMainChart();
            createHeatmap();
            createTimeline();
        });
    </script>
</body>
</html>
